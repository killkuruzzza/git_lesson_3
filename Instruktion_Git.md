# Семинар 3
## 16.09.2022

## **Начало работы с Git**
***
***
***


## Перед началом работы необходимо выполнить следующие настройки:

**git config --global user.name "Your Name"** - указать имя, которым будут подписаны коммиты.
***
**git config --global user.email "e@w.com"** - указать электропочту, которая будет в описании коммитера.
***
> ***Внимание!*** **Эти требования обязательны**

## **Основные команды для работы с Git**
* **Git init** - создать новый проект в текущей директории 
***
* **Git init folder-name** - создать новый проект в указанной директории
***
* **Git log** - вывести список коммитов
***
* **Git status** - показать состояние репозитория (отслеживаемые, изменённые, новые файлы и пр.)
***
* **Git commit -m " "** - зафиксировать в коммите проиндексированные изменения (закоммитить), добавить сообщение
***
* **Git diff** - сравнить рабочую директорию и индекс (неотслеживаемые файлы ИГНОРИРУЮТСЯ)
***
* **Git checkout** - переключиться на коммит с указанным хешем (переместить HEAD на указанный коммит, рабочую директорию вернуть к состоянию, на момент этого коммита)
***
* **git checkout master** - переключиться на коммит, на который указывает master (переместить HEAD на коммит, на который указывает master, рабочую директорию вернуть к состоянию на момент этого коммита)
***
***
***
***
***

## **Немного подробнее о каждой команде:**
***
## Vim (некоторые команды)
***
***
### **_Нажатия кнопок_** (Быстрые клавиши)
***
* **ESC**     — переход в командный режим
***
* **i**       — переход в режим редактирования текста
***
* **ZQ (зажат Shift, поочередное нажатие)** — выход без сохранения
***
* **ZZ (зажат Shift, поочередное нажатие)** — сохранить и выйти

### **_Ввод в командном режиме_**
***
* **:q!**             — выйти без сохранения
***
* **:wq**             — сохранить файл и выйти
***
* **:w filename.txt** — сохранить файл как filename.txt

* **CTRL+C** - копировать
* **CTRL+V** - вставить
* **CTRL+A** - Выделить весь текст
* **CTRL+Z** - Отменить последнее действие. (НЕСКОЛЬКО НАЖАТИЙ ПОДРАД МОГУТ ОТМЕНЯТЬ НЕСКОЛЬКО ПОСЛЕДНИХ ДЕЙСТВИЙ)
***
***
***
***
***
## **Консольные команды**
***
***
### **_Создать новый репозиторий_**
***
***
* **cd имя папки** - перейти в папку, имя которой мы указали
***
* **git push** - отправить локальный репозиторий на GitHub.com
***
* **git clone ссылка на репозиторий на github** - создать локальную копию удаленного репозитория находящегося на github (ссылка на который указана в команде)
***
* **git pull** - подтягивает все изменения удаленного репозитория в локальный репозиторий (простыми словами проводит актуализацию данных)
***
* **git init** - создать новый проект в текущей директории
***
* **git init folder-name** - создать новый проект в указанной директории
***
***
***
## **Клонирование репозитория**
***
* клонировать удаленный репозиторий в одноименную директорию
git clone https://github.com/cyberspacedk/Git-commands.git    
***
* клонировать удаленный репозиторий в директорию «FolderName»
git clone https://github.com/cyberspacedk/Git-commands.git FolderName 
***
* клонировать репозиторий в текущую директорию
git clone https://github.com:nicothin/web-design.git
***
## **Просмотр изменений**
***
* **_git status_** - показать состояние репозитория (отслеживаемые, изменённые, новые файлы и пр.)
***
* **_git diff_** - сравнить рабочую директорию и индекс (неотслеживаемые файлы ИГНОРИРУЮТСЯ)
***
*  **_git diff --color-words_** - сравнить рабочую директорию и индекс, показать отличия в словах (неотслеживаемые файлы ИГНОРИРУЮТСЯ)
***
* **_git diff index.html_** - сравнить файл из рабочей директории и индекс
***
* **_git diff HEAD_** - сравнить рабочую директорию и коммит, на который указывает HEAD (неотслеживаемые файлы ИГНОРИРУЮТСЯ)
***
* **_git diff --staged_** - сравнить индекс и коммит с HEAD
***
* **_git diff master feature_** - посмотреть что сделано в ветке feature по сравнению с веткой master
***
* **_git diff --name-only master feature_** - посмотреть что сделано в ветке feature по сравнению с веткой master, показать только имена файлов
***
* **_git diff master...feature_** посмотреть что сделано в ветке feature с момента (коммита) расхождения с master
***
***
## **Добавление изменений в индекс**
***
* **_git add ._** - добавить в индекс все новые, изменённые, удалённые файлы из текущей директории и её поддиректорий
***
* **_git add text.txt_** - добавить в индекс указанный файл (был изменён, был удалён или это новый файл)
***
* **_git add -i_** - запустить интерактивную оболочку для добавления в индекс только выбранных файлов
***
* **_git add -p_** - показать новые/изменённые файлы по очереди с указанием их изменений и вопросом об отслеживании/индексировании
***
***
## **Удаление изменений из индекса**
***
* **_git reset_** - убрать из индекса все добавленные в него изменения (в рабочей директории все изменения сохранятся), антипод git add
***
* **_git reset readme.txt_** - убрать из индекса изменения указанного файла (в рабочей директории изменения сохранятся)
***
***
## **Отмена изменений**
***
* **_git checkout text.txt_** - ОПАСНО: отменить изменения в файле, вернуть состояние файла, имеющееся в индексе
***
* **_git reset --hard_** - ОПАСНО: отменить изменения; вернуть то, что в коммите, на который указывает HEAD (незакомиченные изменения удалены из индекса и из рабочей директории, неотслеживаемые файлы останутся на месте)
***
***
***
## **Коммиты**
***
* **_git commit -m "Name of commit"_** - зафиксировать в коммите проиндексированные изменения (закоммитить), добавить сообщение
> ***Внимание!*** **Если не указать сообщение, т.есть -m "текст сообщения" то коммит создан не будет и система выдаст ошибку. Возможно придется перезапускат терминал"**
***
* **_git commit -a -m "Name of commit"_** - проиндексировать отслеживаемые файлы (ТОЛЬКО отслеживаемые, но НЕ новые файлы) и закоммитить, добавить сообщение
> ***Внимание!*** **Если не указать сообщение, т.есть -m "текст сообщения" то коммит создан не будет и система выдаст ошибку. Возможно придется перезапускат терминал"**
***
***
### **Отмена коммитов и перемещение по истории**
***
_Все коммиты, которые уже были отправлены в удалённый репозиторий, должны отменяться новыми коммитами (git revert), дабы избежать проблем с историей разработки у других участников проекта._
***
***
* **_git revert HEAD --no-edit_** - создать новый коммит, отменяющий изменения последнего коммита без запуска редактора сообщения
***
* **_git revert b9533bb --no-edit_** - то же, но отменяются изменения, внесённые коммитом с указанным хешем (b9533bb)
***
***
_Все команды, приведённые ниже можно выполнять ТОЛЬКО если коммиты еще не были отправлены в удалённый репозиторий._
> ВНИМАНИЕ! Опасные команды, можно потерять незакоммиченные изменения
***
***
* **_git commit --amend -m "Название"_** - «перекоммитить» изменения последнего коммита, заменить его новым коммитом с другим сообщением (сдвинуть текущую ветку на один коммит назад, сохранив рабочую директорию и индекс «как есть», создать новый коммит с данными из «отменяемого» коммита, но новым сообщением)
***
> ***Внимание!*** **Если не указать сообщение, т.есть -m "текст сообщения" то коммит создан не будет и система выдаст ошибку. Возможно придется перезапускат терминал"**
***
***

* **_git reset --hard @~_** - передвинуть HEAD (и ветку) на предыдущий коммит, рабочую директорию и индекс сделать такими, какими они были в момент предыдущего коммита
***
* **_git reset --hard 75e2d51_** - передвинуть HEAD (и ветку) на коммит с указанным хешем, рабочую директорию и индекс сделать такими, какими они были в момент указанного коммита
***
* **_git reset --soft @~_** - передвинуть HEAD (и ветку) на предыдущий коммит, но в рабочей директории и индексе оставить все изменения
***
* **_git reset --soft @~2_** - то же, но передвинуть HEAD (и ветку) на 2 коммита назад
***
* **_git reset @~_** - передвинуть HEAD (и ветку) на предыдущий коммит, рабочую директорию оставить как есть, индекс сделать таким, каким он был в момент предыдущего коммита (удобнее, чем git reset --soft @~, если индекс нужно задать заново)
***
***
>> Почти как git reset --hard, но безопаснее: не получится потерять изменения в рабочей директории
git reset --keep @~      # передвинуть HEAD (и ветку) на предыдущий коммит, сбросить индекс, но в рабочей директории оставить изменения, если возможно (если файл с изменениями между коммитами менялся, будет выдана ошибка и переключение не произойдёт)
***
***
### **Временно переключиться на другой коммит**
***
* **_git checkout b9533bb_** - переключиться на коммит с указанным хешем (переместить HEAD на указанный коммит, рабочую директорию вернуть к состоянию, на момент этого коммита)
***
* **_git checkout master_** - переключиться на коммит, на который указывает master (переместить HEAD на коммит, на который указывает master, рабочую директорию вернуть к состоянию на момент этого коммита)
***
***
### **Переключиться на другой коммит и продолжить работу с него**
_Потребуется создание новой ветки, начинающейся с указанного коммита._
***
***
* **_git checkout -b new-branch 5589877_** - создать ветку new-branch, начинающуюся с коммита c хешем 5589877 (переместить HEAD на указанный коммит, рабочую директорию вернуть к состоянию, на момент этого коммита, создать указатель на этот коммит (ветку) с указанным именем)
***
***
### **Восстановление изменений**
***
* **_git checkout 5589877 index.html_** - восстановить в рабочей директории указанный файл на момент указанного коммита (и добавить это изменение в индекс) (git reset index.html для удаления из индекса, но сохранения изменений в файле)
***
***
### **История коммитов**
***
> _Выход из длинного лога вывода: q._
***
***
* **_git log master_** - показать коммиты в указанной ветке
***
* **_git log -2_** - показать последние 2 коммита в активной ветке
***
* **_git log -2 --stat_** - показать последние 2 коммита и статистику внесенных ими изменений
***
* **_git log -p -22_** - показать последние 22 коммита и внесенную ими разницу на уровне строк
***
* **_git log --graph -10_** - показать последние 10 коммитов с ASCII-представлением ветвления
***
* **_git log --since=2.weeks_** - показать коммиты за последние 2 недели
***
* **_git log --after '2018-06-30'_** - показать коммиты, сделанные после указанной даты
***
* **_git log index.html_** - показать историю изменений файла index.html (только коммиты)
***
* **_git log -5 index.html_** - показать историю изменений файла index.html, последние 5 коммитов (только коммиты)
***
* **_git log -p index.html_** - показать историю изменений файла index.html (коммиты и изменения)
***
* **_git log -G'myFunction' -p_** - показать все коммиты, в которых менялись строки с myFunction (в кавычках регулярное выражение)
***
* **_git log -L '/<head>/','/<\/head>/':index.html_** - показать изменения от указанного до указанного регулярных выражений в указанном файле
***
* **_git log --grep fix_** - показать коммиты, в описании которых есть буквосочетание fix (регистрозависимо, только коммиты текущей ветки)
***
* **_git log --grep fix -i_** - показать коммиты, в описании которых есть буквосочетание fix (регистроНЕзависимо, только коммиты текущей ветки)
***
* **_git log --grep 'fix(ing|me)' -P_** - показать коммиты, в описании которых есть совпадения для регулярного выражения (только коммиты текущей ветки)
***
* **_git log --pretty=format:"%h - %an, %ar : %s" -4_** - показать последние 4 коммита с форматированием выводимых данных
***
* **_git log --pretty=format:"%h %ad | %s%d [%an]" --graph --date=short_** - мой формат вывода, висящий на алиасе оболочки
***
* **_git log master..branch_99_** - показать коммиты из ветки branch_99, которые не влиты в master
***
* **_git log branch_99..master_** - показать коммиты из ветки master, которые не влиты в branch_99
***
* **_git log master...branch_99 --boundary -- graph_** - показать коммиты из указанных веток, начиная с их расхождения (коммит расхождения будет показан)
***
* **_git show 60d6582_** - показать изменения из коммита с указанным хешем
***
* **_git show HEAD~_** - показать данные о предыдущем коммите в активной ветке
***
* **_git show @~_** - аналогично предыдущему
***
* **_git show HEAD~3_** - показать данные о коммите, который был 3 коммита назад
***
* **_git show my_branch~2_** - показать данные о коммите, который был 2 коммита назад в указанной ветке
***
* **_git show @~:index.html_** - показать контент указанного файла на момент предыдущего (от HEAD) коммита
***
* **_git show :/"подвал"_** - показать самый новый коммит, в описании которого есть указанное слово (из любой вет
***
***
***
# **Основы работы с удаленным репозиторием**
***
### **_git clone_** — создание копии (удаленного) репозитория
> Для начала работы с центральным репозиторием, следует создать копию оригинального проекта со всей его историей локально.

>Клонирует репозиторий, используя протокол http:

>git clone http://user@somehost:port/~user/repository/project.git
Клонирует репозиторий с той же машины в директорию myrepo:

>git clone /home/username/project myrepo
Клонирует репозиторий, используя безопасный протокол ssh:

>git clone ssh://user@somehost:port/~user/repository
>У git имеется и собственный протокол:

>git clone git://user@somehost:port/~user/repository/project.git/
Импортирует svn репозиторий, используя протокол http:

>git svn clone -s http://repo/location
где -s – понимать стандартные папки SVN (trunk, branches, tags)
***
***
### **_git fetch и git pull_** — забираем изменения из центрального репозитория
***
>Для синхронизации текущей ветки с репозиторием используются команды git fetch и git pull.

>git fetch — забирает изменения удаленной ветки из репозитория по умолчания, основной ветки; той, которая была использована при клонировании репозитория. Изменения обновят удаленную ветку (remote tracking branch), после чего надо будет провести слияние с локальной ветку командой git merge.

>Получает изменений из определенного репозитория:

>git fetch /home/username/project
Возможно также использовать синонимы для адресов, создаваемые командой git remote:

>git remote add username-project /home/username/project
git fetch username-project
Естественно, что после оценки изменений, например, командой git diff, надо создать коммит слияния с основной:

>git merge username-project/master
Команда git pull сразу забирает изменения и проводит слияние с активной веткой. Забирает из репозитория, для которого были созданы удаленные ветки по умолчанию:

>git pull
Забирает изменения и метки из определенного репозитория:

>git pull username-project --tags
Как правило, используется сразу команда git pull.
***
***
### **_git push_** — вносим изменения в удаленный репозиторий
***
>После проведения работы в экспериментальной ветке, слияния с основной, необходимо обновить удаленный репозиторий (удаленную ветку). Для этого используется команда git push.

>Отправляет свои изменения в удаленную ветку, созданную при клонировании по умолчанию:

>git push
Отправляет изменения из ветки master в ветку experimental удаленного репозитория:

>git push ssh://yourserver.com/~you/proj.git master:experimental
В удаленном репозитории origin удаляет ветку experimental:

>git push origin :experimental
Отправляет в удаленную ветку master репозитория origin (синоним репозитория по умолчанию) ветки локальной ветки master:

>git push origin master:master
Отправляет метки в удаленную ветку master репозитория origin:

>git push origin master --tags
Изменяет указатель для удаленной ветке master репозитория origin (master будет такой же как и develop):

>git push origin origin/develop:master
Добавляет ветку test в удаленный репозиторий origin, указывающую на коммит ветки develop:

>git push origin origin/develop:refs/heads/test